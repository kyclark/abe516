---
title: "C_elegans_enterococcus"
author: "Ken Youens-Clark"
date: "3/3/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r message = FALSE, warning = FALSE}
setwd("~/work/abe516/project1")

source("http://www.bioconductor.org/biocLite.R")
library("affy")
library("simpleaffy")
library("scales")
library("R.utils")

cwd = getwd()
figure_dir = file.path(cwd, 'figures')

if (!dir.exists(figure_dir)) {
  dir.create(figure_dir)
}
dat = ReadAffy(celfile.path = "data")
num_samples = length(dat)
printf("There are %s features in %s samples\n", length(featureNames(dat)), num_samples)
```

There are four groups:

1. Control
2. B. subtilis
3. E. faecalis
4. E. faecium

```{r groups}
groups = c("C", "Bs", "Efs", "Efm")
fl <- factor(c(rep('0', 2), rep('1', 3), rep('2', 3), rep('3', 3), rep('0', 2)), 
             labels=groups)
palette(brewer_pal(type = "seq", palette = "Set2")(length(groups)))
boxplot(dat, names = fl, main = "Raw", las = 2, col = fl)
```

## MA Plots

A look at the MA plots shows the need for error correction.

```{r maplotraw}
ma_raw = file.path(figure_dir, "ma-raw.png")
png(filename = ma_raw, width = 600, height = 800)
par(mfrow = c(5,3))
MAplot(dat, plot.method = "smoothScatter")
dev.off()
```
![MA Plot (raw)](figures/ma-raw.png)

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
